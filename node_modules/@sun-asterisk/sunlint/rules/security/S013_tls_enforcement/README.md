````markdown
# S013 - Enforce TLS for all connections

## Overview

Rule S013 ensures that applications only create or call secure (HTTPS/TLS) endpoints. It detects insecure server bindings (http.createServer, express app.listen without HTTPS), hard-coded http:// URLs in client calls, and framework-specific misconfigurations that disable TLS.

## Framework Support

- Express.js: detect `http.createServer`, `app.listen` used without TLS wrapper, `app.set('trust proxy', false)` combined with http
- Next.js: detect API routes calling `fetch('http://...')` or new Response created from http sources
- Nuxt.js: detect server config `server: { https: false }` or HTTP public assets
- NestJS: detect direct use of http server via `createServer` or `app.listen` without TLS

## Security Impact

Serving over HTTP or making unencrypted client calls can expose credentials, session tokens, and sensitive data to passive observers. TLS must be enforced for all communication in production.

## Examples

❌ Violation (Express server using http):

```js
const http = require("http");
const server = http.createServer(app);
server.listen(80);
```

❌ Violation (client fetch to http):

```js
await fetch("http://internal-api.local/auth");
```

✅ Compliant (HTTPS enforced):

```js
const https = require("https");
const fs = require("fs");
const server = https.createServer(
  { key: fs.readFileSync("key"), cert: fs.readFileSync("cert") },
  app
);
server.listen(443);
```

## Analysis Approach

- Symbol-based (primary): analyze AST for server creation calls, imports of `http`, usages of `fetch`/`axios`/`request` with `http://` literals, and framework-specific config objects.
- Regex-based (fallback): scan lines for `http.createServer`, `fetch('http://`, `app.listen(` with numeric port 80, `server: { https: false }`, etc.
````
